(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14957,        331]
NotebookOptionsPosition[     14487,        310]
NotebookOutlinePosition[     14833,        325]
CellTagsIndexPosition[     14790,        322]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Monte Carlo Simulation using ",
 StyleBox["Mathematica",
  FontSlant->"Italic"]
}], "Title",
 CellChangeTimes->{{3.6440153941712365`*^9, 3.6440154131881027`*^9}}],

Cell[TextData[{
 "I have used Monte Carlo Simulation for years, but I' ve always used other \
platforms that are more naturally suited to it (JMP, Matlab, R, even Excel). ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " is a tool that I have always used for more pure Mathematics - solving \
equations, etc. - and not for statistical modeling work. But there\
\[CloseCurlyQuote]s no reason that it couldn\[CloseCurlyQuote]t be used for \
Monte Carlo Simulations! It has all of the built in tools and the quick \
calculations for it.\nSo, below is my quick example of a Monte Carlo \
Simulation (of CPU temperatures for a computer - hence the Fan/NoFan temp \
rise over ambient factors."
}], "Text",
 CellChangeTimes->{{3.6441416269011583`*^9, 3.644141705464419*^9}, {
  3.6441417678400025`*^9, 3.644141932722987*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"TempMean", " ", "=", " ", "29.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TempStdDev", " ", "=", " ", "3.2"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LogMu", " ", "=", " ", "0.2"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LogSigma", " ", "=", " ", "0.1"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NoFanMean", " ", "=", " ", "40"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NoFanStdDev", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FanMean", "=", "50"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FanStdDev", " ", "=", " ", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimulateNumber", "=", " ", "10000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ThetaJAMu", "=", "17.1"}], ";", " ", 
  RowBox[{"ThetaJASigma", "=", "0.04"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AmbientTemp", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"TruncatedDistribution", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"20", ",", "40"}], "}"}], ",", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"TempMean", ",", "TempStdDev"}], "]"}]}], "]"}], ",", 
     "SimulateNumber"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ThermalFactor", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"LogNormalDistribution", "[", 
      RowBox[{"LogMu", ",", "LogSigma"}], "]"}], ",", "SimulateNumber"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ThetaJA", " ", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"ThetaJAMu", ",", " ", "ThetaJASigma"}], "]"}], ",", " ", 
     "SimulateNumber"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TROA", " ", "=", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"MixtureDistribution", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"90", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"NoFanMean", ",", "NoFanStdDev"}], "]"}], ",", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"FanMean", ",", "FanStdDev"}], "]"}]}], "}"}]}], "]"}], ",",
      "SimulateNumber"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Temp1", "=", 
   RowBox[{"AmbientTemp", "+", 
    RowBox[{"ThetaJA", "*", "ThermalFactor"}], "+", "TROA"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"TROA", ",", " ", "AmbientTemp", ",", 
     RowBox[{"ThermalFactor", "*", "ThetaJA"}]}], "}"}], ",", "50"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"Temp1", ",", "50"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6440561574078817`*^9, 3.6440563134598303`*^9}, {
  3.6440564173111763`*^9, 3.6440565168088007`*^9}, {3.644056547491743*^9, 
  3.6440566814503813`*^9}, {3.64405683448396*^9, 3.6440568646245503`*^9}, {
  3.644056928446825*^9, 3.6440570247088275`*^9}, {3.6440628465462976`*^9, 
  3.6440628978651524`*^9}, {3.644142012489335*^9, 3.644142319493083*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.413], Thickness[Small]}], {{}, 
     {RGBColor[0.97858, 0.678934, 0.157834], Opacity[0.5], EdgeForm[{Opacity[
      0.413], Thickness[Small]}], RectangleBox[{28., 0.},
       RoundingRadius->0], RectangleBox[{29., 0.}, {30., 2},
       RoundingRadius->0], RectangleBox[{30., 0.}, {31., 6},
       RoundingRadius->0], RectangleBox[{31., 0.}, {32., 25},
       RoundingRadius->0], RectangleBox[{32., 0.}, {33., 51},
       RoundingRadius->0], RectangleBox[{33., 0.}, {34., 119},
       RoundingRadius->0], RectangleBox[{34., 0.}, {35., 215},
       RoundingRadius->0], RectangleBox[{35., 0.}, {36., 357},
       RoundingRadius->0], RectangleBox[{36., 0.}, {37., 638},
       RoundingRadius->0], RectangleBox[{37., 0.}, {38., 862},
       RoundingRadius->0], RectangleBox[{38., 0.}, {39., 1035},
       RoundingRadius->0], RectangleBox[{39., 0.}, {40., 1130},
       RoundingRadius->0], RectangleBox[{40., 0.}, {41., 1240},
       RoundingRadius->0], RectangleBox[{41., 0.}, {42., 1009},
       RoundingRadius->0], RectangleBox[{42., 0.}, {43., 816},
       RoundingRadius->0], RectangleBox[{43., 0.}, {44., 612},
       RoundingRadius->0], RectangleBox[{44., 0.}, {45., 396},
       RoundingRadius->0], RectangleBox[{45., 0.}, {46., 227},
       RoundingRadius->0], RectangleBox[{46., 0.}, {47., 116},
       RoundingRadius->0], RectangleBox[{47., 0.}, {48., 58},
       RoundingRadius->0], RectangleBox[{48., 0.}, {49., 22},
       RoundingRadius->0], RectangleBox[{49., 0.}, {50., 543},
       RoundingRadius->0], RectangleBox[{50., 0.}, {51., 518},
       RoundingRadius->0], RectangleBox[{51., 0.},
       RoundingRadius->0], RectangleBox[{54., 0.},
       RoundingRadius->0]}, {}, {}}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], Opacity[0.5], EdgeForm[{Opacity[
      0.413], Thickness[Small]}], RectangleBox[{20., 0.}, {21., 18},
       RoundingRadius->0], RectangleBox[{21., 0.}, {22., 40},
       RoundingRadius->0], RectangleBox[{22., 0.}, {23., 94},
       RoundingRadius->0], RectangleBox[{23., 0.}, {24., 174},
       RoundingRadius->0], RectangleBox[{24., 0.}, {25., 302},
       RoundingRadius->0], RectangleBox[{25., 0.}, {26., 492},
       RoundingRadius->0], RectangleBox[{26., 0.}, {27., 747},
       RoundingRadius->0], RectangleBox[{27., 0.}, {28., 946},
       RoundingRadius->0], RectangleBox[{28., 0.}, {29., 1106},
       RoundingRadius->0], RectangleBox[{29., 0.}, {30., 1243},
       RoundingRadius->0], RectangleBox[{30., 0.}, {31., 1206},
       RoundingRadius->0], RectangleBox[{31., 0.}, {32., 1078},
       RoundingRadius->0], RectangleBox[{32., 0.}, {33., 910},
       RoundingRadius->0], RectangleBox[{33., 0.}, {34., 718},
       RoundingRadius->0], RectangleBox[{34., 0.}, {35., 424},
       RoundingRadius->0], RectangleBox[{35., 0.}, {36., 242},
       RoundingRadius->0], RectangleBox[{36., 0.}, {37., 132},
       RoundingRadius->0], RectangleBox[{37., 0.}, {38., 76},
       RoundingRadius->0], RectangleBox[{38., 0.}, {39., 36},
       RoundingRadius->0], RectangleBox[{39., 0.}, {40., 16},
       RoundingRadius->0]}, {}, {}}, {{}, 
     {RGBColor[0.560181, 0.691569, 0.194885], Opacity[0.5], EdgeForm[{Opacity[
      0.413], Thickness[Small]}], RectangleBox[{14., 0.},
       RoundingRadius->0], RectangleBox[{15., 0.}, {16., 36},
       RoundingRadius->0], RectangleBox[{16., 0.}, {17., 168},
       RoundingRadius->0], RectangleBox[{17., 0.}, {18., 502},
       RoundingRadius->0], RectangleBox[{18., 0.}, {19., 1071},
       RoundingRadius->0], RectangleBox[{19., 0.}, {20., 1632},
       RoundingRadius->0], RectangleBox[{20., 0.}, {21., 1802},
       RoundingRadius->0], RectangleBox[{21., 0.}, {22., 1754},
       RoundingRadius->0], RectangleBox[{22., 0.}, {23., 1306},
       RoundingRadius->0], RectangleBox[{23., 0.}, {24., 840},
       RoundingRadius->0], RectangleBox[{24., 0.}, {25., 523},
       RoundingRadius->0], RectangleBox[{25., 0.}, {26., 238},
       RoundingRadius->0], RectangleBox[{26., 0.}, {27., 86},
       RoundingRadius->0], RectangleBox[{27., 0.}, {28., 26},
       RoundingRadius->0], RectangleBox[{28., 0.}, {29., 11},
       RoundingRadius->0], RectangleBox[{29., 0.}, {30., 4},
       RoundingRadius->
        0]}, {}, {}}}, {{{{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}, {}}, {{{}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}, {}}, {{{}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{13.18, 0.},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  PlotRange->{{14., 55.}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.644056314207877*^9, {3.644056501088281*^9, 3.644056517467285*^9}, {
   3.6440565509802666`*^9, 3.6440566126842413`*^9}, 3.6440566838166256`*^9, {
   3.644056855269784*^9, 3.644056865417108*^9}, {3.6440569304470205`*^9, 
   3.644057031859541*^9}, {3.644062861090762*^9, 3.6440628986814594`*^9}, {
   3.6441420019735937`*^9, 3.6441420135518265`*^9}, {3.644142099256651*^9, 
   3.6441421761636157`*^9}, 3.644142206695156*^9, 3.6441423228212395`*^9}],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.413], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.413], Thickness[Small]}], RectangleBox[{73., 0}, {74., 2},
      RoundingRadius->0], RectangleBox[{74., 0},
      RoundingRadius->0], RectangleBox[{75., 0}, {76., 3},
      RoundingRadius->0], RectangleBox[{76., 0}, {77., 10},
      RoundingRadius->0], RectangleBox[{77., 0}, {78., 22},
      RoundingRadius->0], RectangleBox[{78., 0}, {79., 32},
      RoundingRadius->0], RectangleBox[{79., 0}, {80., 41},
      RoundingRadius->0], RectangleBox[{80., 0}, {81., 74},
      RoundingRadius->0], RectangleBox[{81., 0}, {82., 127},
      RoundingRadius->0], RectangleBox[{82., 0}, {83., 182},
      RoundingRadius->0], RectangleBox[{83., 0}, {84., 230},
      RoundingRadius->0], RectangleBox[{84., 0}, {85., 328},
      RoundingRadius->0], RectangleBox[{85., 0}, {86., 370},
      RoundingRadius->0], RectangleBox[{86., 0}, {87., 483},
      RoundingRadius->0], RectangleBox[{87., 0}, {88., 571},
      RoundingRadius->0], RectangleBox[{88., 0}, {89., 684},
      RoundingRadius->0], RectangleBox[{89., 0}, {90., 684},
      RoundingRadius->0], RectangleBox[{90., 0}, {91., 726},
      RoundingRadius->0], RectangleBox[{91., 0}, {92., 730},
      RoundingRadius->0], RectangleBox[{92., 0}, {93., 740},
      RoundingRadius->0], RectangleBox[{93., 0}, {94., 652},
      RoundingRadius->0], RectangleBox[{94., 0}, {95., 568},
      RoundingRadius->0], RectangleBox[{95., 0}, {96., 500},
      RoundingRadius->0], RectangleBox[{96., 0}, {97., 411},
      RoundingRadius->0], RectangleBox[{97., 0}, {98., 370},
      RoundingRadius->0], RectangleBox[{98., 0}, {99., 290},
      RoundingRadius->0], RectangleBox[{99., 0}, {100., 258},
      RoundingRadius->0], RectangleBox[{100., 0}, {101., 226},
      RoundingRadius->0], RectangleBox[{101., 0}, {102., 186},
      RoundingRadius->0], RectangleBox[{102., 0}, {103., 139},
      RoundingRadius->0], RectangleBox[{103., 0}, {104., 105},
      RoundingRadius->0], RectangleBox[{104., 0}, {105., 85},
      RoundingRadius->0], RectangleBox[{105., 0}, {106., 64},
      RoundingRadius->0], RectangleBox[{106., 0}, {107., 42},
      RoundingRadius->0], RectangleBox[{107., 0}, {108., 26},
      RoundingRadius->0], RectangleBox[{108., 0}, {109., 15},
      RoundingRadius->0], RectangleBox[{109., 0}, {110., 6},
      RoundingRadius->0], RectangleBox[{110., 0}, {111., 6},
      RoundingRadius->0], RectangleBox[{111., 0}, {112., 6},
      RoundingRadius->0], RectangleBox[{112., 0}, {113., 3},
      RoundingRadius->0], RectangleBox[{113., 0}, {114., 2},
      RoundingRadius->
       0]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{72.18, 0},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  PlotRange->{{73., 114.}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.644056314207877*^9, {3.644056501088281*^9, 3.644056517467285*^9}, {
   3.6440565509802666`*^9, 3.6440566126842413`*^9}, 3.6440566838166256`*^9, {
   3.644056855269784*^9, 3.644056865417108*^9}, {3.6440569304470205`*^9, 
   3.644057031859541*^9}, {3.644062861090762*^9, 3.6440628986814594`*^9}, {
   3.6441420019735937`*^9, 3.6441420135518265`*^9}, {3.644142099256651*^9, 
   3.6441421761636157`*^9}, 3.644142206695156*^9, 3.6441423228837395`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{933, 767},
WindowMargins->{{36, Automatic}, {72, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 180, 5, 101, "Title"],
Cell[763, 29, 823, 14, 125, "Text"],
Cell[CellGroupData[{
Cell[1611, 47, 3308, 86, 452, "Input"],
Cell[4922, 135, 5594, 97, 234, "Output"],
Cell[10519, 234, 3940, 72, 237, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
